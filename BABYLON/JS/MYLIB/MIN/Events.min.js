function listenEvent(eventTarget,eventType,eventHandler){if(eventTarget.addEventListener){eventTarget.addEventListener(eventType,eventHandler,false)}else{if(eventTarget.attachEvent){eventType="on"+eventType;eventTarget.attachEvent(eventType,eventHandler)}else{eventTarget["on"+eventType]=eventHandler}}}function stopListening(eventTarget,eventType,eventHandler){if(eventTarget.removeEventListener){eventTarget.removeEventListener(eventType,eventHandler,false)}else{if(eventTarget.detachEvent){eventType="on"+eventType;eventTarget.detachEvent(eventType,eventHandler)}else{eventTarget["on"+eventType]=null}}}function cancelEvent(event){if(event.preventDefault){event.preventDefault()}else{event.returnValue=false}}function cancelPropagation(event){if(event.stopPropagation){event.stopPropagation()}else{event.cancelBubble=true}}function processClick(evt){evt=evt||window.event;var x=0;var y=0;if(evt.pageX){x=evt.pageX;y=evt.pageY}else{if(evt.clientX){var offsetX=0;var offsetY=0;if(document.documentElement.scrollLeft){offsetX=document.documentElement.scrollLeft;offsetY=document.documentElement.scrollTop}else{if(document.body){offsetX=document.body.scrollLeft;offsetY=document.body.scrollTop}}x=evt.clientX+offsetX;y=evt.clientY+offsetY}}var point=new Object();point.x=x;point.y=y;return point}function processKeyStroke(evt){evt=evt?evt:window.event;var key=evt.charCode?evt.charCode:evt.keyCode;return key}function con_getElementsByClassName(className,root,tagName){if(root){root=typeof root=="string"?document.getElementById(root):root}else{root=document.body}tagName=tagName||"*";if(document.getElementsByClassName){return root.getElementsByClassName(className)}else{var tag=root.getElementsByTagName(tagName);var tagAll=[];for(var i=0;i<tag.length;i++){for(var j=0,n=tag[i].className.split(" ");j<n.length;j++){if(n[j]==className){tagAll.push(tag[i]);break}}}return tagAll}}String.prototype.Trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};function onlyNum(event){event=event||window.event;if(!((event.keyCode>=48&&event.keyCode<=57)||(event.keyCode>=96&&event.keyCode<=105)||(event.keyCode==8)||(event.keyCode==110)||(event.keyCode==190))){cancelEvent(event)}}function regInput(obj,reg,inputStr){var docSel=document.selection.createRange();if(docSel.parentElement().tagName!="INPUT"){return false}oSel=docSel.duplicate();oSel.text="";var srcRange=obj.createTextRange();oSel.setEndPoint("StartToStart",srcRange);var str=oSel.text+inputStr+srcRange.text.substr(oSel.text.length);return reg.test(str)};